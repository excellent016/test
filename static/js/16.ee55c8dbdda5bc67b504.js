webpackJsonp([16],{"3zII":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={data:function(){var t=this;return{net:"/api/upload",avatar:null,ispass:!0,email:"",oldpass:"",ruleForm2:{pass:"",checkPass:""},rules2:{oldpass:[{validator:function(a,e,r){var s,i=t.$cookies.get("cid");t.$axios({url:"/api/student/"+i,method:"get"}).then(function(t){s=t.data.data.pwd}),setTimeout(function(){t.oldpass!=s?r(new Error("请输入正确的密码")):r()},1e3)},trigger:"blur"}],pass:[{validator:function(a,e,r){""===e?r(new Error("请输入密码")):(""!==t.ruleForm2.checkPass&&t.$refs.ruleForm2.validateField("checkPass"),r())},trigger:"blur"}],checkPass:[{validator:function(a,e,r){""===e?r(new Error("请再次输入密码")):e!==t.ruleForm2.pass?r(new Error("两次输入密码不一致!")):r()},trigger:"blur"}],email:[{validator:function(a,e,r){setTimeout(function(){-1==t.email.indexOf("@")&&-1==t.email.indexOf(".com")?r(new Error("请输入合法的邮箱的地址")):r()},1e3)},trigger:"blur"}]}}},created:function(){this.init()},methods:{init:function(){var t=this,a=this.$cookies.get("cid");this.$axios({url:"/api/student/"+a,method:"get"}).then(function(a){t.email=a.data.data.email,t.avatar=a.data.data.avatar})},handleAvatarSuccess:function(t,a){this.avatar=t.data},beforeAvatarUpload:function(t){var a=t.size/1024/1024<2;return a||this.$message.error("上传头像图片大小不能超过 2MB!"),a},submitForm:function(t){var a=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;var e=a.$cookies.get("cid");a.$axios({url:"/api/studentPWD",method:"put",data:{avatar:a.avatar,pwd:a.ruleForm2.pass,studentId:e,email:a.email}}).then(function(t){a.$cookies.set("image",a.avatar),null!=t.data&&a.$message({message:"密码修改成功...",type:"success"})})})},resetForm:function(t){this.avatar=null,this.$refs[t].resetFields(),this.email=""}}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"manager"}},[e("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm2,"status-icon":"",rules:t.rules2,"label-width":"200px"}},[e("h3",{staticClass:"alter"},[t._v("修改你的信息")]),t._v(" "),e("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"旧密码:",prop:"oldpass"}},[e("el-input",{staticStyle:{width:"250px"},attrs:{type:"password",autocomplete:"off"},model:{value:t.oldpass,callback:function(a){t.oldpass=a},expression:"oldpass"}})],1),t._v(" "),e("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"新密码:",prop:"pass"}},[e("el-input",{staticStyle:{width:"250px"},attrs:{type:"password",autocomplete:"off"},model:{value:t.ruleForm2.pass,callback:function(a){t.$set(t.ruleForm2,"pass",a)},expression:"ruleForm2.pass"}})],1),t._v(" "),e("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"确认新密码:",prop:"checkPass"}},[e("el-input",{staticStyle:{width:"250px"},attrs:{type:"password",autocomplete:"off"},model:{value:t.ruleForm2.checkPass,callback:function(a){t.$set(t.ruleForm2,"checkPass",a)},expression:"ruleForm2.checkPass"}})],1),t._v(" "),e("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"个人邮箱:",prop:"email"}},[e("el-input",{staticStyle:{width:"250px"},attrs:{autocomplete:"off"},model:{value:t.email,callback:function(a){t.email=a},expression:"email"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"头像:"}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.net,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.avatar?e("img",{staticClass:"avatar",staticStyle:{width:"80px","margin-left":"-200px"},attrs:{src:t.avatar}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon",staticStyle:{"margin-left":"-300px"}})])],1),t._v(" "),e("el-form-item",[e("el-button",{staticStyle:{"margin-left":"-150px"},attrs:{type:"primary"},on:{click:function(a){return t.submitForm("ruleForm2")}}},[t._v("提交")]),t._v(" "),e("el-button",{on:{click:function(a){return t.resetForm("ruleForm2")}}},[t._v("重置")])],1)],1)],1)},staticRenderFns:[]};var i=e("VU/8")(r,s,!1,function(t){e("Ta8V")},"data-v-59cc9c09",null);a.default=i.exports},Ta8V:function(t,a){}});
//# sourceMappingURL=16.ee55c8dbdda5bc67b504.js.map