webpackJsonp([31],{"3zII":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={data:function(){var t=this;return{net:"http://110.41.45.5:21888/otherApi/upload",avatar:null,ispass:!0,email:"",oldpass:"",active:0,ruleForm0:{userEmail:""},ruleForm1:{userEmail:"",veriCode:""},ruleForm2:{pass:"",checkPass:""},rules0:{},rules1:{},rules2:{oldpass:[{validator:function(e,a,r){var l,s=t.$jwtDecode(sessionStorage.getItem("token")).id;t.$axios({url:"http://110.41.45.5:21888/peopleApi/student/"+s,method:"get"}).then(function(t){l=t.data.data.pwd}),setTimeout(function(){t.oldpass!=l?r(new Error("请输入正确的密码")):r()},1e3)},trigger:"blur"}],pass:[{validator:function(e,a,r){alert(a),""===a?r(new Error("请输入密码")):(""!==t.ruleForm2.checkPass&&t.$refs.ruleForm2.validateField("checkPass"),r())},trigger:"blur"}],checkPass:[{validator:function(e,a,r){""===a?r(new Error("请再次输入密码")):a!==t.ruleForm2.pass?r(new Error("两次输入密码不一致!")):r()},trigger:"blur"}],email:[{validator:function(e,a,r){setTimeout(function(){-1==t.email.indexOf("@")&&-1==t.email.indexOf(".com")?r(new Error("请输入合法的邮箱的地址")):r()},1e3)},trigger:"blur"}]}}},created:function(){this.init()},methods:{before:function(){this.active--},next:function(){this.active++>1&&(this.active=0)},init:function(){var t=this,e=this.$jwtDecode(sessionStorage.getItem("token")).id;this.$axios({url:"http://110.41.45.5:21888/peopleApi/student/"+e,method:"get"}).then(function(e){t.email=e.data.data.email,t.avatar=e.data.data.avatar})},handleAvatarSuccess:function(t,e){this.avatar=t.data},beforeAvatarUpload:function(t){var e=t.size/1024/1024<2;return e||this.$message.error("上传头像图片大小不能超过 2MB!"),e},submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;var a=e.$jwtDecode(sessionStorage.getItem("token")).id;e.$axios({url:"http://110.41.45.5:21888/peopleApi/studentPWD",method:"put",data:{avatar:e.avatar,pwd:e.ruleForm2.pass,studentId:a,email:e.email}}).then(function(t){sessionStorage.setItem("image",e.avatar),null!=t.data&&e.$message({message:"密码修改成功...",type:"success"})})})},resetForm:function(t){this.avatar=null,this.$refs[t].resetFields(),this.email=""}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"manager"}},[a("el-steps",{attrs:{active:t.active,simple:""}},[a("el-step",{staticStyle:{width:"500px"},attrs:{title:"修改信息",icon:"el-icon-edit"}}),t._v(" "),a("el-step",{attrs:{title:"发送验证码",icon:"el-icon-s-promotion"}}),t._v(" "),a("el-step",{attrs:{title:"修改密码",icon:"el-icon-edit"}})],1),t._v(" "),0==t.active?a("el-form",{ref:"ruleForm0",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm0,"status-icon":"",rules:t.rules0,"label-width":"200px"}},[a("h3",{staticClass:"alter"},[t._v("修改信息")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"个人邮箱:"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{autocomplete:"off"},model:{value:t.ruleForm0.userEmail,callback:function(e){t.$set(t.ruleForm0,"userEmail",e)},expression:"ruleForm0.userEmail"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"头像:"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.net,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.avatar?a("img",{staticClass:"avatar",staticStyle:{width:"80px","margin-left":"-200px"},attrs:{src:t.avatar}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",staticStyle:{"margin-left":"-300px"}})])],1),t._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"-150px"},attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm0")}}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){return t.resetForm("ruleForm0")}}},[t._v("重置")]),t._v(" "),a("el-button",{staticStyle:{"margin-top":"12px"},on:{click:t.next}},[t._v("下一步")])],1)],1):t._e(),t._v(" "),1==t.active?a("el-form",{ref:"ruleForm1",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm1,"status-icon":"",rules:t.rules1,"label-width":"200px"}},[a("h3",{staticClass:"alter"},[t._v("发送验证码")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"个人邮箱:"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{autocomplete:"off",disabled:""},model:{value:t.ruleForm1.userEmail,callback:function(e){t.$set(t.ruleForm1,"userEmail",e)},expression:"ruleForm1.userEmail"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"验证码:"}},[a("div",[a("el-input",{staticStyle:{float:"left",width:"100px"},attrs:{autocomplete:"off",maxlength:6},model:{value:t.ruleForm1.veriCode,callback:function(e){t.$set(t.ruleForm1,"veriCode",e)},expression:"ruleForm1.veriCode"}}),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"}},[t._v("点我发送")])],1)]),t._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"-150px"},attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm1")}}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){return t.resetForm("ruleForm1")}}},[t._v("重置")]),t._v(" "),a("el-button",{staticStyle:{"margin-top":"12px"},on:{click:t.before}},[t._v("上一步")]),t._v(" "),a("el-button",{staticStyle:{"margin-top":"12px"},on:{click:t.next}},[t._v("下一步")])],1)],1):t._e(),t._v(" "),2==t.active?a("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm2,"status-icon":"",rules:t.rules2,"label-width":"200px"}},[a("h3",{staticClass:"alter"},[t._v("修改密码")]),t._v(" "),a("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"旧密码:",prop:"oldpass"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{type:"password",autocomplete:"off"},model:{value:t.oldpass,callback:function(e){t.oldpass=e},expression:"oldpass"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"新密码:",prop:"pass"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{type:"password",autocomplete:"off"},model:{value:t.ruleForm2.pass,callback:function(e){t.$set(t.ruleForm2,"pass",e)},expression:"ruleForm2.pass"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"确认新密码:",prop:"checkPass"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{type:"password",autocomplete:"off"},model:{value:t.ruleForm2.checkPass,callback:function(e){t.$set(t.ruleForm2,"checkPass",e)},expression:"ruleForm2.checkPass"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-right":"150px"},attrs:{label:"个人邮箱:",prop:"email"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{autocomplete:"off"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"头像:"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.net,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.avatar?a("img",{staticClass:"avatar",staticStyle:{width:"80px","margin-left":"-200px"},attrs:{src:t.avatar}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon",staticStyle:{"margin-left":"-300px"}})])],1),t._v(" "),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"-150px"},attrs:{type:"primary"},on:{click:function(e){return t.submitForm("ruleForm2")}}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){return t.resetForm("ruleForm2")}}},[t._v("重置")]),t._v(" "),a("el-button",{staticStyle:{"margin-top":"12px"},on:{click:t.before}},[t._v("上一步")]),t._v(" "),a("el-button",{staticStyle:{"margin-top":"12px"},on:{click:t.next}},[t._v("下一步")])],1)],1):t._e()],1)},staticRenderFns:[]};var s=a("VU/8")(r,l,!1,function(t){a("NGJS")},"data-v-10fadc37",null);e.default=s.exports},NGJS:function(t,e){}});
//# sourceMappingURL=31.8f9d0bbde50d1deae4be.js.map