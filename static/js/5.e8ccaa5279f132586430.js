webpackJsonp([5],{frMi:function(e,t){},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(e,t,a){var s=a("FeBl"),o=s.JSON||(s.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},uIdB:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),o=a.n(s),i=a("woOf"),n=a.n(i),r=a("Dd8w"),l=a.n(r),c=(a("4Nz2"),a("NYxO")),d={name:"login",data:function(){return{rotate:Math.floor(100*Math.random()+220),value3:0,isShow:!0,noShow:!1,role:2,valid:1111,time:60,isTouch:!1,imageSrc:"",imageUrl:"",imageShow:!1,countdown:!1,labelPosition:"left",formLabelAlign:{username:"20154084",password:"123456",verify:""}}},methods:{showImage:function(){var e=this;this.$axios({url:"/api/getVerifiCodeImage",method:"get",responseType:"blob"}).then(function(t){var a=URL.createObjectURL(new Blob([t.data]));console.log(t.data),e.imageSrc=a})},downTime:function(){var e=this,t=setInterval(function(){e.time--,e.countdown=!0,0==e.time&&(clearInterval(t),e.time=60,e.noShow=!1,e.isShow=!0,e.countdown=!1)},1e3)},handleClose:function(e){e()},send:function(){var e=this;this.isTouch=!0,this.rotate=Math.floor(130*Math.random()+120),this.$cookies.set("rotate",this.rotate),this.$axios({url:"/api/rorate",method:"get"}).then(function(t){e.imageUrl=t.data.data})},changeSlider:function(e){this.value3=0,this.rotate=this.$cookies.get("rotate")},all:function(e){var t=this;0==this.value3&&(this.rotate=this.$cookies.get("rotate"),this.$cookies.set("nowValue",0));var a=this.$cookies.get("nowValue"),s=this.value3;if(this.$cookies.set("nowValue",this.value3),this.rotate=s>a?Math.floor(this.rotate)+s-a:Math.floor(this.rotate)-(a-s),console.log(Math.abs(360-this.rotate)),Math.abs(360-this.rotate)<=7){this.isTouch=!1,this.rotate=0;var o=this.formLabelAlign.username;this.$axios({url:"/api/send/"+o,method:"get"}).then(function(e){console.log(e.data.data),t.valid=e.data.data,200==e.data.code&&(t.$message({type:"success",message:"验证码已发送到你的邮箱"}),t.isShow=!1,t.noShow=!0,t.noShow&&t.downTime()),400==e.data.code&&(t.isShow=!1,t.noShow=!1,t.imageShow=!0,t.showImage())}).catch(function(){t.$message({type:"error",message:"网络出差了"})})}},login:function(){var e=this;""!=this.formLabelAlign.verify?(this.countdown&&(console.log("登录操作执行-------"),this.$axios({url:"/api/login",method:"post",data:l()({},this.formLabelAlign)}).then(function(t){if(200==t.data.code){var a=t.data.data;if(null!=a)switch(a.role){case"0":e.$cookies.set("cname",a.adminName),e.$cookies.set("cid",a.adminId),e.$cookies.set("role",0);var s=n()({name:"token",val:a.adminId},{startTime:(new Date).getTime()});sessionStorage.setItem("token",o()(s)),e.$router.push({path:"/index"});break;case"1":e.$cookies.set("cname",a.teacherName),e.$cookies.set("cid",a.teacherId),e.$cookies.set("image",a.avatar);s=n()({name:"token",val:a.teacherId},{startTime:(new Date).getTime()});sessionStorage.setItem("token",o()(s)),e.$cookies.set("role",1),e.$router.push({path:"/index"});break;case"2":e.$cookies.set("cname",a.studentName),e.$cookies.set("cid",a.studentId);s=n()({name:"token",val:a.studentId},{startTime:(new Date).getTime()});sessionStorage.setItem("token",o()(s)),e.$cookies.set("image",a.avatar),e.$router.push({path:"/student"})}}if(350==t.data.code&&(e.$message({type:"error",message:"验证码错误,请重新输入"}),e.formLabelAlign.verify=""),400==t.data.code){var i=new WebSocket(e.$websocketUrl,t.data.data.currentId),r={};r.sender=t.data.data.currentId,r.receiver=t.data.data.wantLogin,r.message="is_lock",console.log(i.readyState),1===i.readyState?i.send(o()(r)):0===i.readyState?setTimeout(function(){i.send(o()(r))},300):setTimeout(function(){i.send(o()(r))},500),e.$message({showClose:!0,type:"error",message:t.data.message})}450==t.data.code&&e.$message({showClose:!0,type:"error",message:t.data.message})})),0==this.time&&(this.$message({type:"error",message:"验证码已失效,请重新发送"}),this.formLabelAlign.verify=""),this.countdown||(console.log("登录操作执行-------"),this.$axios({url:"/api/login",method:"post",data:l()({},this.formLabelAlign)}).then(function(t){if(200==t.data.code){var a=t.data.data;if(null!=a)switch(a.role){case"0":e.$cookies.set("cname",a.adminName),e.$cookies.set("cid",a.adminId),e.$cookies.set("image",a.avatar),e.$cookies.set("role",0);var s=n()({name:"token",val:a.adminId},{startTime:(new Date).getTime()});sessionStorage.setItem("token",o()(s)),e.$router.push({path:"/index"});break;case"1":e.$cookies.set("cname",a.teacherName),e.$cookies.set("cid",a.teacherId),e.$cookies.set("image",a.avatar);s=n()({name:"token",val:a.teacherId},{startTime:(new Date).getTime()});sessionStorage.setItem("token",o()(s)),e.$cookies.set("role",1),e.$router.push({path:"/index"});break;case"2":e.$cookies.set("cname",a.studentName),e.$cookies.set("cid",a.studentId);s=n()({name:"token",val:a.studentId},{startTime:(new Date).getTime()});sessionStorage.setItem("token",o()(s)),e.$cookies.set("image",a.avatar),e.$router.push({path:"/student"})}}if(350==t.data.code&&(e.$message({type:"error",message:"验证码错误,请重新输入"}),e.showImage(),e.formLabelAlign.verify=""),400==t.data.code){var i=new WebSocket(e.$websocketUrl,t.data.data.currentId),r={};r.sender=t.data.data.currentId,r.receiver=t.data.data.wantLogin,r.message="is_lock",console.log(i.readyState),1===i.readyState?i.send(o()(r)):0===i.readyState?setTimeout(function(){i.send(o()(r))},300):setTimeout(function(){i.send(o()(r))},500),e.$message({showClose:!0,type:"error",message:t.data.message})}450==t.data.code&&e.$message({showClose:!0,type:"error",message:t.data.message})}))):this.$message({type:"error",message:"验证码不能为空"})},clickTag:function(e){this.role=e}},computed:Object(c.c)(["userInfo"]),mounted:function(){}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"login"}},[a("div",{staticClass:"bg"}),e._v(" "),a("el-row",{staticClass:"main-container"},[a("el-col",{attrs:{lg:8,xs:16,md:10,span:10}},[a("div",{staticClass:"top"},[a("i",{staticClass:"iconfont icon-kaoshi"}),a("span",{staticClass:"title"},[e._v("在线考试系统")])]),e._v(" "),a("div",{staticClass:"bottom"},[a("div",{staticClass:"container"},[a("p",{staticClass:"title"},[e._v("账号登录")]),e._v(" "),a("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.formLabelAlign}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.formLabelAlign.username,callback:function(t){e.$set(e.formLabelAlign,"username",e._n(t))},expression:"formLabelAlign.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.formLabelAlign.password,callback:function(t){e.$set(e.formLabelAlign,"password",t)},expression:"formLabelAlign.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"验证码"}},[a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticStyle:{width:"120px"},attrs:{placeholder:"请输入验证码"},model:{value:e.formLabelAlign.verify,callback:function(t){e.$set(e.formLabelAlign,"verify",t)},expression:"formLabelAlign.verify"}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticStyle:{width:"80px","margin-left":"30px","padding-right":"80px"},attrs:{type:"primary"},on:{click:e.send}},[e._v("点我发送")]),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.noShow,expression:"noShow"}],staticStyle:{width:"120px"},attrs:{placeholder:"请输入验证码"},model:{value:e.formLabelAlign.verify,callback:function(t){e.$set(e.formLabelAlign,"verify",t)},expression:"formLabelAlign.verify"}}),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.noShow,expression:"noShow"}],staticStyle:{width:"80px","margin-left":"30px","padding-left":"40px","padding-right":"40px","text-align":"center"},attrs:{type:"primary"}},[e._v(e._s(e.time))]),e._v(" "),a("el-dialog",{attrs:{title:"请把图片旋转到正常角度",visible:e.isTouch,width:"20%","before-close":e.handleClose},on:{"update:visible":function(t){e.isTouch=t}}},[a("div",[a("img",{staticStyle:{width:"30%",height:"30%","border-radius":"50%","margin-left":"70px"},style:{transform:"rotate("+e.rotate+"deg)"},attrs:{src:e.imageUrl}}),e._v(" "),a("el-slider",{attrs:{min:0,max:360,"show-tooltip":!1},on:{input:function(t){return e.all(t)},change:function(t){return e.changeSlider(t)}},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}})],1)]),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:e.imageShow,expression:"imageShow"}],staticStyle:{width:"120px",float:"left"},attrs:{placeholder:"请输入验证码"},model:{value:e.formLabelAlign.verify,callback:function(t){e.$set(e.formLabelAlign,"verify",t)},expression:"formLabelAlign.verify"}}),e._v(" "),a("el-image",{directives:[{name:"show",rawName:"v-show",value:e.imageShow,expression:"imageShow"}],staticStyle:{float:"right",width:"100px",height:"38px","margin-left":"50px"},attrs:{src:e.imageSrc,title:"点我刷新"},on:{click:e.showImage}})],1),e._v(" "),a("div",{staticClass:"submit"},[a("el-button",{staticClass:"row-login",attrs:{type:"primary"},on:{click:function(t){return e.login()}}},[e._v("登录")])],1)],1)],1)])])],1),e._v(" "),a("el-row",{staticClass:"footer"},[a("el-col",[a("p",{staticClass:"msg2"},[e._v("版权所有 ©2023 保留所有权利  "),a("a",{attrs:{href:"http://beian.miit.gov.cn/",target:"_blank"}},[e._v("赣ICP备19001371号")])])])],1)],1)},staticRenderFns:[]};var h=a("VU/8")(d,m,!1,function(e){a("frMi")},"data-v-63b0093a",null);t.default=h.exports}});
//# sourceMappingURL=5.e8ccaa5279f132586430.js.map